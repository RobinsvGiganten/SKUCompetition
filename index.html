<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Memory Match</title>
  <style>
    :root{
      --bg: #0f1221;
      --panel: #151a2e;
      --accent: #6ee7ff;
      --accent-2: #a78bfa;
      --text: #e6e9ff;
      --muted: #9aa4bf;
      --good: #5ee1a9;
      --bad: #ff7a7a;
      --card: #1b2140;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif; color:var(--text);
      background: radial-gradient(1200px 800px at 20% 0%, #1a1f3a, transparent),
                  radial-gradient(1200px 800px at 100% 0%, #122035, transparent),
                  var(--bg);
      display:flex; flex-direction:column; align-items:center;
    }
    header{
      width:100%; max-width:1100px; padding:18px 20px; position:sticky; top:0; z-index:5;
      backdrop-filter: blur(8px);
    }
    .bar{
      display:flex; gap:12px; align-items:center; justify-content:space-between;
      background: color-mix(in oklab, var(--panel) 90%, transparent);
      border:1px solid #2a335d; border-radius:16px; padding:12px 14px;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    .left, .right{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .badge{background:#0f1430; border:1px solid #2a335d; padding:8px 10px; border-radius:12px; color:var(--muted)}
    .badge b{color:var(--text)}
    button, select{
      appearance:none; border:none; border-radius:12px; padding:10px 14px; cursor:pointer;
      background: linear-gradient(180deg, #2a335d, #232a4e); color:var(--text); font-weight:600;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.08), 0 6px 16px rgba(0,0,0,.35);
    }
    button:hover{filter:brightness(1.08)}
    button:active{transform:translateY(1px)}
    select{padding-right:34px}

    main{width:100%; max-width:1100px; padding:16px 20px 40px}

    .grid{
      display:grid; gap:12px;
      grid-template-columns: repeat(auto-fit, minmax(86px, 1fr));
    }

    .card{
      aspect-ratio: 3/4; perspective:900px; position:relative; outline:none;
    }
    .card-inner{
      position:absolute; inset:0; border-radius:16px; transform-style:preserve-3d; transition: transform .45s cubic-bezier(.2,.7,.2,1);
    }
    .card.is-flipped .card-inner{ transform: rotateY(180deg); }
    .face{
      position:absolute; inset:0; display:grid; place-items:center; border-radius:16px; backface-visibility:hidden;
      border:1px solid #2a335d; box-shadow: 0 10px 20px rgba(0,0,0,.35);
    }
    .front{
      background: linear-gradient(180deg, #22284b, #1a1f3f);
    }
    .back{
      background: linear-gradient(180deg, #202646, #1a1f3b);
      transform: rotateY(180deg);
    }
    .symbol{font-size: clamp(28px, 5.6vw, 44px)}

    .matched .front{ border-color: #2d9d7c; box-shadow: 0 10px 24px rgba(45,157,124,.35)}

    footer{opacity:.7; margin:24px 0 36px; font-size:.9rem}

    /* Dialog */
    dialog{ border:none; border-radius:20px; padding:0; color:var(--text);
      background: linear-gradient(180deg, #1b2040, #12162e);
      box-shadow: 0 30px 80px rgba(0,0,0,.45);
      max-width: 500px; width: 92vw; }
    .dlg-body{ padding:24px; }
    .dlg-actions{ display:flex; gap:10px; padding:16px 24px; background:#0f1430; border-top:1px solid #2a335d; justify-content:flex-end }

    /* Accessibility helpers */
    .sr-only{position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0}

    @media (min-width: 1200px){
      .grid{ grid-template-columns: repeat(6, 1fr); }
    }
  </style>
</head>
<body>
  <header>
    <div class="bar" role="toolbar" aria-label="Game controls">
      <div class="left">
        <span class="badge" id="moves">Moves: <b>0</b></span>
        <span class="badge" id="time">Time: <b>00:00</b></span>
        <span class="badge" id="best">Best: <b>â€”</b></span>
      </div>
      <div class="right">
        <label class="sr-only" for="size">Board size</label>
        <select id="size" aria-label="Board size">
          <option value="12">Easy (12 cards)</option>
          <option value="16" selected>Normal (16 cards)</option>
          <option value="20">Hard (20 cards)</option>
          <option value="24">Insane (24 cards)</option>
        </select>
        <button id="restart" type="button">Restart â†»</button>
      </div>
    </div>
  </header>

  <main>
    <h1 class="sr-only">Memory Match Game</h1>
    <div id="grid" class="grid" aria-live="polite"></div>
  </main>

  <dialog id="win">
    <div class="dlg-body">
      <h2>ðŸŽ‰ Nice! You cleared the board</h2>
      <p id="winStats">You finished in 0 moves.</p>
    </div>
    <div class="dlg-actions">
      <button id="playAgain">Play again</button>
      <button id="closeWin">Close</button>
    </div>
  </dialog>

  <footer>
    <p>Built with plain HTML/CSS/JS. Keyboard: Tab to focus, Enter/Space to flip.</p>
  </footer>

  <script>
  (()=>{
    const grid = document.getElementById('grid');
    const movesEl = document.querySelector('#moves b');
    const timeEl = document.querySelector('#time b');
    const bestEl = document.querySelector('#best b');
    const sizeSel = document.getElementById('size');
    const restartBtn = document.getElementById('restart');
    const dlg = document.getElementById('win');
    const playAgain = document.getElementById('playAgain');
    const closeWin = document.getElementById('closeWin');

    // Emoji pool (pairs will be created from a slice of this)
    const EMOJI = ['ðŸ¸','ðŸ¦„','ðŸ¦Š','ðŸ¼','ðŸµ','ðŸ¯','ðŸ¦','ðŸ¤','ðŸ™','ðŸ³','ðŸ','ðŸ¦‹','ðŸŒ™','â­','âš¡','ðŸ”¥','ðŸ€','ðŸ“','ðŸ•','ðŸ¥¨','âš½','ðŸŽ§','ðŸŽ®','ðŸŽ²','ðŸ’Ž','ðŸš€','ðŸ›¸','ðŸŽ¯','ðŸ§©','ðŸ’¡'];

    let first=null, second=null, lock=false, matches=0, moves=0, started=false, secs=0, timer=null, totalCards=16;

    function format(s){
      const m = Math.floor(s/60).toString().padStart(2,'0');
      const r = (s%60).toString().padStart(2,'0');
      return `${m}:${r}`;
    }

    function startTimer(){ if(timer) return; timer = setInterval(()=>{ secs++; timeEl.textContent = format(secs); }, 1000); }
    function stopTimer(){ clearInterval(timer); timer=null; }
    function resetTimer(){ stopTimer(); secs=0; timeEl.textContent = '00:00'; }

    function shuffle(arr){
      for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; }
      return arr;
    }

    function buildDeck(n){
      const pairs = n/2;
      const pick = shuffle(EMOJI.slice()).slice(0, pairs);
      const deck = shuffle([...pick, ...pick]).map((sym, idx)=>({ id: idx+''+Math.random().toString(16).slice(2,6), sym, matched:false }));
      return deck;
    }

    function cardTemplate(card){
      return `<button class="card" data-id="${card.id}" aria-label="Hidden card" aria-pressed="false">
        <div class="card-inner">
          <div class="face front" aria-hidden="true"></div>
          <div class="face back"><div class="symbol" aria-hidden="true">${card.sym}</div></div>
        </div>
      </button>`;
    }

    function render(deck){
      grid.innerHTML = deck.map(cardTemplate).join('');
      grid.querySelectorAll('.card').forEach(btn=>{
        btn.addEventListener('click', ()=> flip(btn));
        btn.addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); flip(btn); }});
      });
    }

    function setFlipped(btn, on){
      btn.classList.toggle('is-flipped', on);
      btn.setAttribute('aria-pressed', on?'true':'false');
    }

    function bumpMoves(){ moves++; movesEl.textContent = moves; }

    function flip(btn){
      if(lock) return; if(btn.classList.contains('is-flipped')) return;
      setFlipped(btn, true);
      if(!started){ started=true; startTimer(); }
      if(!first){ first = btn; return; }
      second = btn; lock=true; bumpMoves();

      const sym1 = first.querySelector('.symbol')?.textContent;
      const sym2 = second.querySelector('.symbol')?.textContent;
      if(sym1 === sym2){
        first.classList.add('matched');
        second.classList.add('matched');
        first = second = null; lock=false; matches += 2;
        if(matches === totalCards){ win(); }
      } else {
        setTimeout(()=>{
          setFlipped(first, false); setFlipped(second, false);
          first = second = null; lock=false;
        }, 700);
      }
    }

    function win(){
      stopTimer();
      const stats = `Moves: ${moves} â€¢ Time: ${format(secs)}`;
      document.getElementById('winStats').textContent = stats;
      const bestKey = `best_${totalCards}`;
      const best = JSON.parse(localStorage.getItem(bestKey) || 'null');
      const current = { moves, secs };
      if(!best || current.moves < best.moves || (current.moves === best.moves && current.secs < best.secs)){
        localStorage.setItem(bestKey, JSON.stringify(current));
      }
      updateBestLabel();
      dlg.showModal();
    }

    function updateBestLabel(){
      const best = JSON.parse(localStorage.getItem(`best_${totalCards}`) || 'null');
      bestEl.textContent = best ? `${best.moves} / ${format(best.secs)}` : 'â€”';
    }

    function reset(n){
      totalCards = n;
      first=second=null; lock=false; matches=0; moves=0; started=false; movesEl.textContent = '0';
      resetTimer();
      const deck = buildDeck(n);
      render(deck);
      updateBestLabel();
    }

    // hooks
    restartBtn.addEventListener('click', ()=> reset(totalCards));
    sizeSel.addEventListener('change', e=> reset(parseInt(e.target.value,10)) );
    playAgain.addEventListener('click', ()=>{ dlg.close(); reset(totalCards); });
    closeWin.addEventListener('click', ()=> dlg.close());

    // init
    reset(totalCards);
  })();
  </script>
</body>
</html>
